# 目標
以 python 實現子網段計算小工具

# 計算子網路方法
[參考連結1](https://bluemuta38.pixnet.net/blog/post/45543389)

[參考連結2](https://github.com/tehmaze/ipcalc/blob/master/ipcalc.py)

假設實驗室起始地址為 `140.113.215.33`，我們將之當作閘道(gateway)，最多配置 30 台主機，那我們的主機 bit數為 5 個 bits，這樣才可以配置夠 30 台，也可以 log_2 30 取上高斯得 5 bits。

`32 bits = 27 網路 bits + 5 主機 bits`

所以我們可以求得 subnet mask 為
```
     255 .      255 .      255 .      224
11111111 . 11111111 . 11111111 . 11100000
------------------------------------*****
                                    ^---^
                                     Host
```

因此，子網路遮罩就告訴我們此網段的配置主機個數，只要知道
* 起始 ip
* 子網路遮罩
就可以推算出此網段的所有主機 ip 及個數

最後，怎麼求 Net ID，Host ID 呢 ? 也很簡單:

IP 和 mask 做 and 得 Net ID，意思為主機 IP 全 0，代表的是一個網段，為網路地址，所有主機 IP 全 1，代表是廣播地址，所以以下圖為例

```
   10001100.01110001.11010111.00101001
&) 11111111.11111111.11111111.11100000
---------------------------------------------
   10001100.01110001.11010111.00100000
        140.     113.     215.      32
```
```
10001100.01110001.11010111.00100000 (140.113.215.32) 網路地址
10001100.01110001.11010111.00111111 (140.113.215.63) 廣播地址
之間的範圍 IP 為所有子網路的 IP
```

再來求先將 subnet Mask 做一個 NOT 運算，可以得出
```
00000000.00000000.00000000.00011111
```

然後再和 IP 做一次 AND 運算，就可以得到 Host ID，以`140.113.215.41`為例，補充主機的 Host ID 必須是唯一的

```
   10001100.01110001.11010111.00101001
&) 00000000.00000000.00000000.00011111
---------------------------------------------
   00000000.00000000.00000000.00001001
          0.       0.       0.       9
```


換成十進位就成 : 0.0.0.9。表示是該網域從 .32 開始數第 9 個主機，也可以說是此網段第 9 個 IP
(32, 33, 34, 35, 36, 37, 38, 39, 40, 41...)

那這邊可以發現，其實我們只要知道

**其中一台的 IP 跟 子網路遮罩**

我們可以求得網段的所有IP跟地址範圍、主機個數 

酷吧 = =

也因此，140.113.215.33 ~ 140.113.215.62 做如 140.113.215.(33~62) / 27 都是一樣結果 

## 問題
已知 ip = 140.113.215.56, subnet mask = 255.255.255.224，求 ip 範圍及個數，Host ID

```
 
1. 由 subnet mask 知 總共有 32 - 2 (網路、廣播) 個主機，表示法為 140.113.215.56 / 27(網路地址 bit 數)
2. ip & mask = 140.113.215.32 為網路地址，140.113.215.63(後主機bits全1) 為廣播地址。 
3. 所以合法 ip 為 140.113.215.33 ~ 140.113.215.62
```

最後補充
>Gateway主要功能是用來"連接兩個不同的網段"。也就是說,如果系統判定目的端為不同網段,就會將封包丟給Gateway來做轉送,反之,如果判定為相同網段,即直接傳到目的端,不會經由Gateway

> subnet mask 是用來判斷是否為同一個網域，假設兩 ip A, B
```
X = A & mask  
Y = B & mask
if X == Y : same net
else : different net 
```

## 範例執行
```bash
sh test.sh
```